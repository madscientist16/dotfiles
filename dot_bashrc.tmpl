# vim: set ft=bash:

## ENVIRONMENT VARIABLES
{{ if eq .chezmoi.os "linux" -}}

if ! [[ "$PATH" =~ "$HOME/.local/bin:$HOME/stl/prefix:$HOME/.cargo/bin:" ]]; then
    PATH="$HOME/.local/bin:$HOME/stl/prefix:$HOME/.cargo/bin:$PATH"
fi
export PATH
export EDITOR="nvim"
export VISUAL=$EDITOR
export WINEDLLOVERRIDES="winemenubuilder.exe=d"

{{- else if eq .chezmoi.os "android" -}}

if ! [[ "$PATH" =~ "$HOME/.local/bin:" ]]; then
    PATH="$HOME/.local/bin:$PATH"
fi
export PATH
export EDITOR="nvim"
export VISUAL=$EDITOR

{{- end }}
{{ if eq .chezmoi.hostname "laptop" -}}

# Old laptop with Arch Linux
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket" # for systemd ssh agent
export STEAM_FORCE_DESKTOPUI_SCALING=1.5

{{- end }}

# If not running interactively, don't do anything
[[ $- != *i* ]] && return

## SETTINGS
# Prompt
PS1='\[\e[0;32m\]\w\[\e[1;32m\]\n‚ùØ \[\e[0m\]'

# History
HISTSIZE=1000
HISTFILE=$HOME/.bash_history
HISTFILESIZE=$HISTSIZE
HISTCONTROL=ignoreboth:erasedups

# Misc
shopt -s autocd
shopt -s extglob

## KEYBINDINGS
bind '"\e[A": history-substring-search-backward'
bind '"\e[B": history-substring-search-forward'

## ALIASES
{{ if eq .chezmoi.os "linux" -}}

alias sudo='sudo ' # for using aliases with sudo
alias ls='eza --icons=auto --group-directories-first'
alias ll='eza -l --icons=auto --group-directories-first'
alias la='eza -la --icons=auto --group-directories-first'
alias sys='systemctl'
alias sysu='systemctl --user'
alias fire='firewall-cmd'
alias chez='chezmoi'
alias venv='python3 -m venv'

# Flatpak
alias protontricks='flatpak run com.github.Matoking.protontricks'
alias protontricks-launch='flatpak run --command=protontricks-launch com.github.Matoking.protontricks'

{{- else if eq .chezmoi.os "android" -}}

alias ls='eza --icons=auto --group-directories-first'
alias ll='eza -l --icons=auto --group-directories-first --no-user'
alias la='eza -la --icons=auto --group-directories-first --no-user'
alias chez='chezmoi'
alias venv='python3 -m venv'

{{- end }}
{{ if eq .chezmoi.hostname "laptop" -}}

# Old laptop with Arch Linux
alias update-mirrors='sudo mv /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak \
    && rate-mirrors --protocol https arch --max-delay 3600 | sudo tee /etc/pacman.d/mirrorlist'
alias clean-packages='sudo pacman -R $(pacman -Qtdq)'

{{- end }}

eval "$(fzf --bash)"
eval "$(zoxide init bash --cmd cd)"
